var kio=function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=NaN,n="[object Symbol]",o=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt,l="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")(),d=Object.prototype.toString,p=Math.max,g=Math.min,h=function(){return u.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&d.call(e)==n}(e))return t;if(f(e)){var l="function"==typeof e.valueOf?e.valueOf():e;e=f(l)?l+"":l}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var c=r.test(e);return c||s.test(e)?a(e.slice(2),c?2:8):i.test(e)?t:+e}var m=function(e,t,n){var o,i,r,s,a,l,c=0,u=!1,d=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var n=o,r=i;return o=i=void 0,c=t,s=e.apply(r,n)}function w(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=r}function k(){var e=h();if(w(e))return y(e);a=setTimeout(k,function(e){var n=t-(e-l);return d?g(n,r-(e-c)):n}(e))}function y(e){return a=void 0,m&&o?b(e):(o=i=void 0,s)}function O(){var e=h(),n=w(e);if(o=arguments,i=this,l=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(k,t),u?b(e):s}(l);if(d)return a=setTimeout(k,t),b(l)}return void 0===a&&(a=setTimeout(k,t)),s}return t=v(t)||0,f(n)&&(u=!!n.leading,r=(d="maxWait"in n)?p(v(n.maxWait)||0,t):r,m="trailing"in n?!!n.trailing:m),O.cancel=function(){void 0!==a&&clearTimeout(a),c=0,o=l=i=a=void 0},O.flush=function(){return void 0===a?s:y(h())},O},b=Uint8Array,w=Uint16Array,k=Int32Array,y=new b([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),O=new b([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),T=new b([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),A=function(e,t){for(var n=new w(31),o=0;o<31;++o)n[o]=t+=1<<e[o-1];var i=new k(n[30]);for(o=1;o<30;++o)for(var r=n[o];r<n[o+1];++r)i[r]=r-n[o]<<5|o;return{b:n,r:i}},P=A(y,2),j=P.b,C=P.r;j[28]=258,C[258]=28;for(var E=A(O,0).r,I=new w(32768),$=0;$<32768;++$){var _=(43690&$)>>1|(21845&$)<<1;_=(61680&(_=(52428&_)>>2|(13107&_)<<2))>>4|(3855&_)<<4,I[$]=((65280&_)>>8|(255&_)<<8)>>1}var S=function(e,t,n){for(var o=e.length,i=0,r=new w(t);i<o;++i)e[i]&&++r[e[i]-1];var s,a=new w(t);for(i=1;i<t;++i)a[i]=a[i-1]+r[i-1]<<1;if(n){s=new w(1<<t);var l=15-t;for(i=0;i<o;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],d=a[e[i]-1]++<<u,p=d|(1<<u)-1;d<=p;++d)s[I[d]>>l]=c}else for(s=new w(o),i=0;i<o;++i)e[i]&&(s[i]=I[a[e[i]-1]++]>>15-e[i]);return s},N=new b(288);for($=0;$<144;++$)N[$]=8;for($=144;$<256;++$)N[$]=9;for($=256;$<280;++$)N[$]=7;for($=280;$<288;++$)N[$]=8;var L=new b(32);for($=0;$<32;++$)L[$]=5;var q=S(N,9,0),D=S(L,5,0),M=function(e){return(e+7)/8|0},x=function(e,t,n){n<<=7&t;var o=t/8|0;e[o]|=n,e[o+1]|=n>>8},z=function(e,t,n){n<<=7&t;var o=t/8|0;e[o]|=n,e[o+1]|=n>>8,e[o+2]|=n>>16},R=function(e,t){for(var n=[],o=0;o<e.length;++o)e[o]&&n.push({s:o,f:e[o]});var i=n.length,r=n.slice();if(!i)return{t:H,l:0};if(1==i){var s=new b(n[0].s+1);return s[n[0].s]=1,{t:s,l:1}}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var a=n[0],l=n[1],c=0,u=1,d=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=i-1;)a=n[n[c].f<n[d].f?c++:d++],l=n[c!=u&&n[c].f<n[d].f?c++:d++],n[u++]={s:-1,f:a.f+l.f,l:a,r:l};var p=r[0].s;for(o=1;o<i;++o)r[o].s>p&&(p=r[o].s);var g=new w(p+1),h=U(n[u-1],g,0);if(h>t){o=0;var f=0,v=h-t,m=1<<v;for(r.sort((function(e,t){return g[t.s]-g[e.s]||e.f-t.f}));o<i;++o){var k=r[o].s;if(!(g[k]>t))break;f+=m-(1<<h-g[k]),g[k]=t}for(f>>=v;f>0;){var y=r[o].s;g[y]<t?f-=1<<t-g[y]++-1:++o}for(;o>=0&&f;--o){var O=r[o].s;g[O]==t&&(--g[O],++f)}h=t}return{t:new b(g),l:h}},U=function(e,t,n){return-1==e.s?Math.max(U(e.l,t,n+1),U(e.r,t,n+1)):t[e.s]=n},G=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new w(++t),o=0,i=e[0],r=1,s=function(e){n[o++]=e},a=1;a<=t;++a)if(e[a]==i&&a!=t)++r;else{if(!i&&r>2){for(;r>138;r-=138)s(32754);r>2&&(s(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(s(i),--r;r>6;r-=6)s(8304);r>2&&(s(r-3<<5|8208),r=0)}for(;r--;)s(i);r=1,i=e[a]}return{c:n.subarray(0,o),n:t}},V=function(e,t){for(var n=0,o=0;o<t.length;++o)n+=e[o]*t[o];return n},B=function(e,t,n){var o=n.length,i=M(t+2);e[i]=255&o,e[i+1]=o>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var r=0;r<o;++r)e[i+r+4]=n[r];return 8*(i+4+o)},F=function(e,t,n,o,i,r,s,a,l,c,u){x(t,u++,n),++i[256];for(var d=R(i,15),p=d.t,g=d.l,h=R(r,15),f=h.t,v=h.l,m=G(p),b=m.c,k=m.n,A=G(f),P=A.c,j=A.n,C=new w(19),E=0;E<b.length;++E)++C[31&b[E]];for(E=0;E<P.length;++E)++C[31&P[E]];for(var I=R(C,7),$=I.t,_=I.l,M=19;M>4&&!$[T[M-1]];--M);var U,F,W,H,Q=c+5<<3,K=V(i,N)+V(r,L)+s,J=V(i,p)+V(r,f)+s+14+3*M+V(C,$)+2*C[16]+3*C[17]+7*C[18];if(l>=0&&Q<=K&&Q<=J)return B(t,u,e.subarray(l,l+c));if(x(t,u,1+(J<K)),u+=2,J<K){U=S(p,g,0),F=p,W=S(f,v,0),H=f;var X=S($,_,0);x(t,u,k-257),x(t,u+5,j-1),x(t,u+10,M-4),u+=14;for(E=0;E<M;++E)x(t,u+3*E,$[T[E]]);u+=3*M;for(var Z=[b,P],Y=0;Y<2;++Y){var ee=Z[Y];for(E=0;E<ee.length;++E){var te=31&ee[E];x(t,u,X[te]),u+=$[te],te>15&&(x(t,u,ee[E]>>5&127),u+=ee[E]>>12)}}}else U=q,F=N,W=D,H=L;for(E=0;E<a;++E){var ne=o[E];if(ne>255){z(t,u,U[(te=ne>>18&31)+257]),u+=F[te+257],te>7&&(x(t,u,ne>>23&31),u+=y[te]);var oe=31&ne;z(t,u,W[oe]),u+=H[oe],oe>3&&(z(t,u,ne>>5&8191),u+=O[oe])}else z(t,u,U[ne]),u+=F[ne]}return z(t,u,U[256]),u+F[256]},W=new k([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),H=new b(0),Q=function(e,t,n,o,i,r){var s=r.z||e.length,a=new b(o+s+5*(1+Math.ceil(s/7e3))+i),l=a.subarray(o,a.length-i),c=r.l,u=7&(r.r||0);if(t){u&&(l[0]=r.r>>3);for(var d=W[t-1],p=d>>13,g=8191&d,h=(1<<n)-1,f=r.p||new w(32768),v=r.h||new w(h+1),m=Math.ceil(n/3),T=2*m,A=function(t){return(e[t]^e[t+1]<<m^e[t+2]<<T)&h},P=new k(25e3),j=new w(288),I=new w(32),$=0,_=0,S=r.i||0,N=0,L=r.w||0,q=0;S+2<s;++S){var D=A(S),x=32767&S,z=v[D];if(f[x]=z,v[D]=x,L<=S){var R=s-S;if(($>7e3||N>24576)&&(R>423||!c)){u=F(e,l,0,P,j,I,_,N,q,S-q,u),N=$=_=0,q=S;for(var U=0;U<286;++U)j[U]=0;for(U=0;U<30;++U)I[U]=0}var G=2,V=0,H=g,Q=x-z&32767;if(R>2&&D==A(S-Q))for(var K=Math.min(p,R)-1,J=Math.min(32767,S),X=Math.min(258,R);Q<=J&&--H&&x!=z;){if(e[S+G]==e[S+G-Q]){for(var Z=0;Z<X&&e[S+Z]==e[S+Z-Q];++Z);if(Z>G){if(G=Z,V=Q,Z>K)break;var Y=Math.min(Q,Z-2),ee=0;for(U=0;U<Y;++U){var te=S-Q+U&32767,ne=te-f[te]&32767;ne>ee&&(ee=ne,z=te)}}}Q+=(x=z)-(z=f[x])&32767}if(V){P[N++]=268435456|C[G]<<18|E[V];var oe=31&C[G],ie=31&E[V];_+=y[oe]+O[ie],++j[257+oe],++I[ie],L=S+G,++$}else P[N++]=e[S],++j[e[S]]}}for(S=Math.max(S,L);S<s;++S)P[N++]=e[S],++j[e[S]];u=F(e,l,c,P,j,I,_,N,q,S-q,u),c||(r.r=7&u|l[u/8|0]<<3,u-=7,r.h=v,r.p=f,r.i=S,r.w=L)}else{for(S=r.w||0;S<s+c;S+=65535){var re=S+65535;re>=s&&(l[u/8|0]=c,re=s),u=B(l,u+1,e.subarray(S,re))}r.i=s}return function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new b(e.subarray(t,n))}(a,0,o+M(u)+i)},K=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,o=9;--o;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),J=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8};function X(e,t){t||(t={});var n=function(){var e=-1;return{p:function(t){for(var n=e,o=0;o<t.length;++o)n=K[255&n^t[o]]^n>>>8;e=n},d:function(){return~e}}}(),o=e.length;n.p(e);var i,r=function(e,t,n,o,i){if(!i&&(i={l:1},t.dictionary)){var r=t.dictionary.subarray(-32768),s=new b(r.length+e.length);s.set(r),s.set(e,r.length),e=s,i.w=r.length}return Q(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,o,i)}(e,t,10+((i=t).filename?i.filename.length+1:0),8),s=r.length;return function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&J(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var o=0;o<=n.length;++o)e[o+10]=n.charCodeAt(o)}}(r,t),J(r,s-8,n.d()),J(r,s-4,o),r}var Z="undefined"!=typeof TextDecoder&&new TextDecoder;try{Z.decode(H,{stream:!0}),1}catch(e){}const Y=["DEBUG","INFO","WARN","ERROR","FATAL"],ee=["#9c27b0","#0288d1","#ed6c02","#d32f2f","#d32f2f"];class te{static fmt({level:e="DEBUG",scope:t,message:n}){const o=new Date,i=e.toUpperCase();return["%c%s %c[⛳️ KIO]%c%s %c(%s):","color: #999;",`[${o.toLocaleTimeString("zh")}.${o.getMilliseconds()}]`,"font-weight: bold; background: rgb(82, 59, 175); color: #ddd; margin-right: 1ch;",`color: ${ee[Y.indexOf(i)]};`,i,...t?["color: #bbb;",t]:[]].concat(n)}}te.debugImpl=e=>console.debug.apply(null,te.fmt(e)),te.logImpl=e=>console.info.apply(null,te.fmt(e)),te.warnImpl=e=>console.warn.apply(null,te.fmt(e)),te.errorImpl=e=>console.error.apply(null,te.fmt(e)),te.auto=e=>{switch(e.level){case"FATAL":return te.errorImpl(e);case"ERROR":case"WARN":case"INFO":return te.debugImpl(e);default:return}},te.getLoggerByLevel=e=>(t,n,o)=>te.auto(Object.assign(Object.assign({},o),{scope:t,message:n,level:e})),te.fatal=te.getLoggerByLevel("FATAL"),te.error=te.getLoggerByLevel("ERROR"),te.warn=te.getLoggerByLevel("WARN"),te.info=te.getLoggerByLevel("INFO"),te.log=te.getLoggerByLevel("INFO"),te.debug=te.getLoggerByLevel("DEBUG");const ne=new TextEncoder,oe=e=>"string"==typeof e?e:JSON.stringify(e);function ie(e,t,n,o){const i=new XMLHttpRequest;i.open("POST",e,!n),i.setRequestHeader("Content-Type",(o?"text/plain":"application/json")+"; charset=utf-8"),i.send(oe(t))}const re=(e,t)=>{ie(e,t,!0,!0)},se=(e,t)=>{if("Request"in window&&"keepalive"in Request.prototype)((e,t)=>{fetch(e,{method:"POST",keepalive:!0,headers:{"Content-Type":"text/plain; charset=utf-8"},body:oe(t),credentials:"omit"}).then((e=>e),(n=>{te.fatal("batch-delivery",["Cannot submit batch.",{endpoint:e,data:t},n.stack])})).catch((()=>{}))})(e,t);else if("sendBeacon"in navigator)try{if(!navigator.sendBeacon(e,oe(t)))throw new Error;te.debug("batch-delivery","Request has been sent via `sendBeacon` as fallback, since fetch with keepalive=true is not available.")}catch(n){te.debug("batch-delivery","Request has been sent via synchronous XHR as fallback, since beacon / fetch is failed."),re(e,t)}else te.debug("batch-delivery","Request has been sent via synchronous XHR as fallback, since beacon / fetch is not available."),re(e,t)};function ae(e){window.parent.postMessage(JSON.stringify(e),"*")}function le(e){const t=new Map(document.cookie.split("; ").filter(Boolean).map((e=>{const[t,...n]=e.split("=");return[decodeURIComponent(t),decodeURIComponent(n.join("="))]}))),n=Array.from(t.entries());return"function"==typeof e?n.filter((t=>e(t[0]))):t.get(e)||""}function ce(e,t,n){const[o,...i]=e.trim().split("?"),r=i.join("?");if(!r)return`${o}?${t}=${n}`;const s=r.split("#")[1],a=ge(e),l=a.map((e=>e.key)).indexOf(t);return`${o}?${(l>-1?a.slice(0,l).concat([{key:t,value:n}],a.slice(l+1)):a.concat([{key:t,value:n}])).map((e=>`${e.key}=${e.value}`)).join("&")}${s?"#":""}${s||""}`}function ue(e){return JSON.parse(JSON.stringify(e))}function de(e,...t){const n=e.tagName.toLowerCase();return t.indexOf(n)>-1}function pe(){return le("qhdi")||"none"}function ge(e){return((e.trim().split("?")[1]||"").split("#")[0]||"").replace(/&+/g,"&").split("&").filter((e=>e)).map((e=>{const t=e.split("=");return{key:t[0],value:t.slice(1).join("=")}}))}function he(e){const t=ge(e),n={utm_campaign:"",utm_content:"",utm_medium:"",utm_source:""},o=Object.keys(n);for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i.key)>-1&&(n[i.key]=i.value)}return n}const fe=e=>window.btoa(String.fromCharCode.apply(null,Array.from((e=>X(ne.encode(e),{level:4}))(e))));function ve(e){const{pathname:t,host:n,hash:o}=window.location;if(!e||"history"===e.toLowerCase())return n+t;const i=-1===o.indexOf("?")?void 0:o.indexOf("?");return"/"===t[t.length-1]?n+t+o.slice(2,i):n+t+o.slice(1,i)}const me="actionstat.kujiale.com",be={sendManualTrack(e,t,n=!1){ie(`https://${me}/api/toolbehaviors/${e}/${n?"multilog":"log"}`,t)},sendAutoTrack(e,t){t?navigator.sendBeacon?navigator.sendBeacon(`https://${me}/v2/api/eventtrack/text`,JSON.stringify(e)):ie(`https://${me}/v2/api/eventtrack`,e,!0):ie(`https://${me}/v2/api/eventtrack`,e)},sendConversionGoal(e){ie(`https://${me}/api/toolbehaviors/yuntaiGeneralTargetAction/log`,e)}},we="data-kioid",ke="data-kio",ye="data-kmetricname",Oe="data-kmetrics",Te="data-kiocg";function Ae(e){return e.getAttribute(ye)||""}function Pe(e){return Ee(e,ke)}function je(e){return Ee(e,Oe)}function Ce(e){return e.getAttribute(Te)||""}function Ee(e,t){return Array.prototype.reduce.call(e.attributes,((e,n)=>{if(0===n.name.indexOf(t+"-")||0===n.name.indexOf(t+"_")){const o=n.name.slice(t.length).match(/^_?(\w*)-?(.*)$/),i=o?o[1]:"",r=o?o[2].split("-").map(((e,t)=>t>0?e[0].toUpperCase()+e.slice(1):e)).join(""):"",s=n.value;if("number"===i)return Object.assign(e,{[r]:Number(s)});if("string"===i)return Object.assign(e,{[r]:String(s)});if("json"===i)try{return Object.assign(e,{[r]:JSON.parse(s)})}catch(t){return Object.assign(e,{[r]:s})}return"true"===s||"false"===s?Object.assign(e,{[r]:"true"===s}):Object.assign(e,{[r]:s})}return e}),{})}function Ie(e,t){let n={},o={},i={},r="",s="",a=e,l=null;const c=[],u=[],d=[];for(;a&&!de(a,"html");){!l&&de(a,"a")&&(l=a,n=Object.assign(n,{href:(g=l.getAttribute("href")||"",0===g.indexOf("data:")?g.slice(0,g.indexOf(",")):g)})),""===r&&(r=Ae(a),r&&(i=je(a)));const e=Pe(a);p=e,0!==Object.keys(p).length&&(o=Object.assign(e,o)),""===s&&(s=Ce(a));const{pathUnit:h,elementIdUnit:f,classIdUnit:v}=_e(a,t.classIdMode);c.unshift(h),u.unshift(f),t.classIdMode&&d.unshift(v),a=a.parentElement}var p,g,h;return n=Object.assign(n,function(e){const{top:t,right:n,bottom:o,left:i}=e.getBoundingClientRect(),r=window.pageYOffset,s=window.pageXOffset;return{top:Math.round(t+r),right:Math.round(n+s),bottom:Math.round(o+r),left:Math.round(i+s)}}(e),{nodeText:Le(l||e),title:qe(l||e),elementId:(h=u,["html"].concat(h).reverse().reduce(((e,t)=>0===e.length?e.concat(t):e[e.length-1].indexOf("#")>-1?e:e.concat(t)),[]).reverse().join(" > ")),path:$e(c),classId:$e(t.classIdMode?d:c)}),{element:n,autoTrackCustomized:o,manualTrackName:r,manualTrackData:i,conversionGoal:s}}function $e(e){return e.join(">")}function _e(e,t){const n=e.tagName.toLowerCase(),o=function(e){return e.getAttribute(we)||""}(e)||e.getAttribute("id"),i=e.getAttribute("id");let r=0,s=0;const a=e.parentElement.children;for(let t=0;t<a.length;t++)a[t].tagName.toLowerCase()===n&&(a[t]===e&&(s=r),r++);let l={pathUnit:o?`${n}:${s}#${o}`:`${n}:${s}`,elementIdUnit:i?`${n}#${i}`:`${n}${r>1?`:eq(${s})`:""}`};if(t){const t=function(e){return[].join.call(e.classList,",")}(e)||o;l=Object.assign(l,{classIdUnit:t?`${n}:${s}#${t}`:`${n}:${s}`})}return l}function Se(e){return e.replace(/\s+/g," ").trim()}const Ne=100;function Le(e){return de(e,"a")?Se(e.innerText.slice(0,Ne)):Se([].filter.call(e.childNodes,(e=>3===e.nodeType)).map((e=>e.textContent)).join(" ").slice(0,Ne))}function qe(e){return e.getAttribute("title")||""}const De={globalProps:{},autoTrackExtraPayload:{},kioConfig:{},pubCanaryApps:null,get pubCanaryAppNamesCsv(){var e,t;return(null===(e=this.pubCanaryApps)||void 0===e?void 0:e.length)?(t=this.pubCanaryApps,t.filter((function(e,t,n){return n.indexOf(e,0)===t}))).join(","):void 0},pubAppName:null,pubAppVersion:null,pubAppStage:null,userTrialFlag:"",qhdi:null,gaGaCookie:void 0,gaCtnrCookie:void 0,utm:{utm_campaign:"",utm_content:"",utm_medium:"",utm_source:""},eventBus:new class{constructor(){this.events=new Map}on(e,t){const n=this.events.get(e);n?n.push(t):this.events.set(e,[t])}off(e,t){const n=this.events.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):this.events.set(e,[]))}once(e,t){const n=(...o)=>{this.off(e,n),t(...o)};this.on(e,n)}emit(e,t){let n=this.events.get(e);n&&n.slice().map((e=>{e(t)})),n=this.events.get("*"),n&&n.slice().map((n=>{n(e,t)}))}}},Me=()=>"undefined"!=typeof window&&void 0!==window.document,xe=()=>{if(Me()&&window.document.cookie)return De.gaGaCookie=le("_ga")||void 0,De.gaCtnrCookie=le((e=>e.startsWith("_ga_"))).map((([e,t])=>`${e}=${t}`)).join(",")||void 0,{gaCookie:De.gaGaCookie,ctnrCookie:De.gaCtnrCookie};te.info("collectors.ga","No cookies found or unsupported enviroment, ignored.")},ze={multilog:e=>({url:"/api/batch-multilog-text",data:e.map((({job:{body:e,name:t,shared:n},queuedAt:o})=>{var i,r;const s={_action_behavior:t,_trackEventName:t,list:e,common:Object.assign(Object.assign({},n),{_clientEnqueueTime:o,_clientSendTime:Date.now(),_ga:De.gaGaCookie||(null===(i=xe())||void 0===i?void 0:i.gaCookie),_ga_session_states:De.gaCtnrCookie||(null===(r=xe())||void 0===r?void 0:r.ctnrCookie)})},a=Object.keys(s.common).filter((e=>e.startsWith("_")||e.startsWith("$"))),l=Object.assign({},s.common),c={};return a.forEach((e=>{c[e]=l[e],delete l[e]})),(s.list||[]).forEach((e=>{De.eventBus.emit("events.custom-events.pre-send",{eventName:(null==t?void 0:t.toLowerCase())||"",rawEventName:t||"",defaultProps:c,ownProps:Object.assign(Object.assign({},l),e),$enqueueHandler:"legacy-multilog"})})),s}))}),log:e=>({url:"/api/batch-log-text",data:e.map((({job:{body:e,name:t,shared:n},queuedAt:o})=>{var i,r;const s=Object.keys(n).filter((e=>e.startsWith("_")||e.startsWith("$"))),a={_action_behavior:t,_trackEventName:t,_clientEnqueueTime:o,_clientSendTime:Date.now(),_ga:De.gaGaCookie||(null===(i=xe())||void 0===i?void 0:i.gaCookie),_ga_session_states:De.gaCtnrCookie||(null===(r=xe())||void 0===r?void 0:r.ctnrCookie)},l=Object.assign(Object.assign({},n),e);return s.forEach((e=>{a[e]=l[e],delete l[e]})),De.eventBus.emit("events.custom-events.pre-send",{eventName:(null==t?void 0:t.toLowerCase())||"",rawEventName:t||"",defaultProps:a,ownProps:l,$enqueueHandler:"legacy-log"}),Object.assign(Object.assign({},a),l)}))}),eventTrack:e=>{const t=e.map((e=>Object.assign({clientQueueDelayedMs:Date.now()-e.queuedAt},e.job.body)));return{url:"/v2/api/eventtrack/batch-auto-collected-events",data:t.length?fe(JSON.stringify(t)):t}}},Re=e=>{const t=e.reduce(((e,t)=>{switch(t.job.key){case"eventTrack":e.eventTrack.push(t);break;case"log":e.log.push(t);break;case"multilog":e.multilog.push(t)}return e}),{eventTrack:[],log:[],multilog:[]}),n=(e,t)=>{const n=`https://actionstat.kujiale.com${e}${(()=>{var e;return Object.entries(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},De.pubAppName&&{"pub-pn":De.pubAppName}),De.pubAppVersion&&{"pub-pv":De.pubAppVersion}),De.pubAppStage&&{"pub-stage":De.pubAppStage}),De.userTrialFlag&&{"is-trial-user":De.userTrialFlag}),(null===(e=null===window||void 0===window?void 0:window.g_kio)||void 0===e?void 0:e.userId)&&{userid:window.g_kio.userId}),{"kio-version":"3.8.1"})).map((([e,t],n)=>`${0===n?"?":""}${e}=${window.encodeURIComponent(t)}`)).join("&")})()}`;Array.isArray(t)&&0===t.length||se(n,t)};Object.keys(ze).map((e=>ze[e](t[e]))).forEach((({data:e,url:t})=>n(t,e)))};class Ue{constructor(e,t,n,o,i){this.eventName=e,this.origProperties=t,this.origGlobalProps=Object.assign({},o),this.origSharedProps=n,this.workingProperties=this.origProperties,this.workingSharedProps=this.origSharedProps,this.workingGlobalProps=this.origGlobalProps,this.checkOnly=i}liftCommonPairsToSharedProps(){const e=this.workingProperties[0]&&Object.keys(this.workingProperties[0]).filter((e=>this.workingProperties.every((t=>t[e]===this.workingProperties[0][e]))));if(null==e?void 0:e.length){const t={};this.workingProperties=this.workingProperties.map((n=>Object.keys(n).reduce(((o,i)=>(e.includes(i)?t[i]=n[i]:o[i]=n[i],o)),{}))),this.workingSharedProps=Object.assign(Object.assign({},t),this.workingSharedProps),te.debug("event-optimizer",`Properties {${e.join(", ")}} of event "${this.eventName}" have been lifted to shared props since every record in the list are identical.`)}return te.debug("event-optimizer",`Properties {${e.join(", ")}} of event "${this.eventName}" have been lifted to shared props since every record in the list are identical.`),this}dedupSharedPropsAsPerGlobalProps(){const e=new Set;return this.workingSharedProps=Object.keys(this.workingSharedProps).reduce(((t,n)=>(Object.keys(this.origGlobalProps).includes(n)&&this.origGlobalProps[n]===this.workingSharedProps[n]?e.add(n):t[n]=this.workingSharedProps[n],t)),{}),e.size&&te.debug("event-optimizer",`Shared properties {${[...e.values()].join(", ")}} of event "${this.eventName}" overlap with the corresponding props in the global props. To reduce the size of batch, KIO has removed the corresponding fields.`),this}dedupEventPropsAsPerParentProps(){const e=Object.keys(this.origGlobalProps),t=Object.keys(this.workingSharedProps),n=new Set;return this.workingProperties.map((o=>Object.keys(o).reduce(((i,r)=>(e.includes(r)&&this.origGlobalProps[r]===o[r]||t.includes(r)&&this.workingSharedProps[r]===o[r]?n.add(r):i[r]=o[r],i)),{}))),n.size&&te.debug("event-optimizer",`Properties {${[...n.values()].join(", ")}} of event "${this.eventName}" overlap with the corresponding props in the global or shared props. To reduce the size of batch, KIO has removed the corresponding fields.`),this}dropIllegalKeyingProperties(){const e=new Set,t=t=>Object.keys(t).reduce(((n,o)=>(/^(?![\$_\d])[A-Za-z0-9_]+$/.test(o)?n[o]=t[o]:e.add(o),n)),{});return this.workingProperties=this.workingProperties.map(t),this.workingSharedProps=t(this.workingSharedProps),e.size&&te.warn("event-validator",`Illegal properties {${[...e.values()].join(", ")}} of event "${this.eventName}" have been removed.`),this}dropEmptyPropertiesRecord(){return this.workingProperties=this.workingProperties.filter((e=>e&&Object.keys(e).length)),this}getProps(){return{properties:this.workingProperties,sharedProps:this.workingSharedProps}}}class Ge{constructor(e){this.queue=[],this.size=30,this.ttl=3e3,this.intervalId=0,this.queueName="default",this.size=e.size,this.onQueueFull=e.onQueueFull,this.onQueueFlush=e.onQueueCommit,this.dispatcher=e.dispatcher,this.queueName=e.name,Number.isFinite(e.ttl)&&(this.ttl=e.ttl)}flushQueue(e,t){var n;this.pushJob(e),this.dispatcher(this.queue.slice(),t),null===(n=this.onQueueFlush)||void 0===n||n.call(this),this.queue.length=0}poll(e){const t=Date.now();e&&!this.queue.some((n=>t-n.queuedAt>e))||this.flushQueue(null,"polling")}startPolling(e=3e3){this.intervalId=window.setInterval((()=>{this.poll(e)}),e),this.intervalId&&te.info("pending-queue",`Start polling queue <${this.queueName}>. interval=${e}ms, jobTtl=${this.ttl}ms, batchSize=${this.size}.`)}stopPolling(){this.intervalId&&(this.flushQueue(null,"stop-polling"),window.clearInterval(this.intervalId),te.info("pending-queue",`Stop polling queue <${this.queueName}>.`))}pushJob(e){e&&this.queue.push({job:e,queuedAt:Date.now()})}enqueue(e){var t;this.pushJob(e),this.poll(this.ttl),this.queue.length>=this.size&&(this.flushQueue(null,"queue-full"),null===(t=this.onQueueFull)||void 0===t||t.call(this))}}const Ve=()=>{if(!Me())return void te.info("collectors.pmc","PMC can only be initialized in a browser enviroment hosting by Pub.");const e=window.MutationObserver||window.WebKitMutationObserver;if(!e)return void te.info("collectors.pmc","Collector cannot be registered since MutationObserver API is not available.");const t=()=>{if(De.pubAppVersion&&["defaulttag","defualttag"].includes(De.pubAppVersion)){const e=document.querySelectorAll("micro > script[type='pub-meta']");if(e.length){const t=Array.from(e).filter((e=>"gray"===e.getAttribute("pv"))).map((e=>e.getAttribute("pn"))).filter((e=>!!e));De.pubCanaryApps=t}}},n=new e(((e,n)=>{(()=>{if(!De.pubAppName){const e=document.querySelector("head > script[type='pub-meta']");if(e){const t=e.getAttribute("pn"),n=e.getAttribute("pv");De.pubAppName=t,De.pubAppVersion=n}}})(),(()=>{if(!De.pubAppStage){const e=document.querySelector("head > meta[name='serviceWithStage']");e&&(De.pubAppStage=e.getAttribute("content")||null)}})(),e.some((e=>Array.from(e.addedNodes).concat(Array.from(e.removedNodes)).some((e=>{return(t=e).nodeType===Node.ELEMENT_NODE&&"SCRIPT"==t.nodeName&&"pub-meta"===e.type;var t}))))&&t()})),o=()=>{t(),n.observe(window.document.body,{childList:!0}),te.info("collectors.pmc",[`Initialized. pan=${De.pubAppName}, pas=${De.pubAppStage}, pav=${De.pubAppVersion}`])};n.observe(window.document.head,{childList:!0}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()};function Be(e){const t=ge(e),n={spm_pre:null,spm_url:null},o=Object.keys(n);for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i.key)>-1&&(n[i.key]=i.value)}return n}function Fe(e){var t,n;if(null===(t=null==e?void 0:e.hasAttribute)||void 0===t?void 0:t.call(e,"data-spm-cnt")){const t=e.getAttribute("data-spm-cnt");let o=(null===(n=null==e?void 0:e.getAttribute)||void 0===n?void 0:n.call(e,"data-spm"))||"",i={};(function(e){try{return JSON.parse(e),!0}catch(e){return!1}})(o)&&(i=JSON.parse(o));return Object.assign(Object.assign({},i),{spm:{spm_cnt:t}})}return null}function We(e,t){if(!t)return"";const{spm_cnt:n,spm_url:o}=e;let i="/"===t?"":t,r={};n&&(r.spm_url=n),o&&(r.spm_pre=o);for(const[e,t]of Object.entries(r))i=ce(i,e,t);return i}var He;!function(e){e.LOAD="load",e.UNLOAD="unload"}(He||(He={}));let Qe,Ke=null;const Je=new Map,Xe=new Map,Ze=({pageEventTimestamp:e,userId:t,sendTrackEvent:n,mergeAutoTrackData:o})=>{if(!Me())return void console.info("[kio] spm-link-collector can only be initialized in a browser environment hosting by Pub.");const i=pe();Ke={_one_env:"web",_one_code:i,_qhdi:i};const r=e=>{const t=e.target,o=Fe(t),{data:i,type:r,spm:s={}}=o||{},a=Object.assign({},s,Be(window.location.href));if(!o||!d("click",r))return;const l=u({eventType:"clickEvent",customized:i});if(n("ClickEvent",Object.assign(Object.assign({},a),l)),de(t,"a")){const e=t.getAttribute("href")||"",n=We(a,e);(function(e){return/^(https?:)?\/\/?/.test(e)})(e)&&(t.href=n)}},s=e=>{const t=e.target,n=Fe(t),{type:o}=n||{};if(!n||!d("hover",o))return;const i=Date.now();Xe.set(t,i)},a=e=>{const t=e.target,n=t.closest("[data-spm-cnt]"),o=Fe(t),{type:i}=o||{};if(!o||!d("hover",i)||t!==n)return;const r=Xe.get(t);r&&(c({name:"HoverEvent",target:t,timestamp:r,type:"hoverEvent"}),Xe.delete(t))},l=()=>{(()=>{const t=u({eventType:"pageEvent",triggerTimestamp:e});n("VisitEvent",Object.assign(Object.assign({},t),{status:He.LOAD}))})(),document.body.addEventListener("click",r,!0),document.body.addEventListener("mouseenter",s,!0),document.body.addEventListener("mouseleave",a,!0)};function c({name:e,target:t,timestamp:o,type:i,sendImmediately:r}){const s=Fe(t),{data:a,spm:l={}}=s||{},c=Date.now()-o,d=u({eventType:i,customized:a}),p="hoverEvent"===i?{hoverTime:c/1e3}:{expTime:c/1e3};c>500&&n(e,Object.assign(Object.assign(Object.assign(Object.assign({},l),d),p),{startTime:o}),{sendImmediately:r})}function u({eventType:e,triggerTimestamp:n,customized:i}){const r=o({eventType:e,triggerTimestamp:n,customized:i});return Object.assign({userId:t},r,Ke,Be(window.location.href))}function d(e,t){return!t||(t instanceof Array?t.includes(e):Object.is(t,e))}if("loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l(),window.addEventListener("beforeunload",(()=>{const t=Date.now(),o=(t-e)/1e3,i=u({eventType:"pageEvent",triggerTimestamp:t});n("VisitEvent",Object.assign(Object.assign({},i),{status:He.UNLOAD,visitTime:o}),{sendImmediately:!0}),Qe&&clearInterval(Qe),document.body.removeEventListener("click",r,!0),document.body.removeEventListener("mouseenter",s,!0),document.body.removeEventListener("mouseleave",a,!0),null==Je||Je.forEach(((e,t)=>{c({name:"ExposureEvent",target:t,timestamp:e,sendImmediately:!0,type:"exposureEvent"})})),null==Xe||Xe.forEach(((e,t)=>{c({name:"HoverEvent",target:t,timestamp:e,sendImmediately:!0,type:"hoverEvent"})}))})),!window.IntersectionObserver)return void console.info("[kio] `window.IntersectionObserver` is not found.");const p=new IntersectionObserver(((e,t)=>{e.forEach((e=>{((e,t)=>{const n=Fe(t),{type:o}=n||{};if(n&&d("exp",o))if(e>0&&!Je.has(t)){const e=Date.now();Je.set(t,e)}else 0===e&&Je.has(t)&&(c({name:"ExposureEvent",target:t,timestamp:Je.get(t),type:"exposureEvent"}),Je.delete(t))})(e.intersectionRatio,e.target)}))}),{threshold:[0,1]});var g;g=e=>{e.forEach((e=>{p.observe(e)}))},Qe=setInterval((()=>{const e=document.querySelectorAll("[data-spm-cnt]");e.length>0&&(g(e),clearInterval(Qe))}),300)},Ye=e=>JSON.stringify(e),et=(e,t,n="_blank")=>{const o=Fe(e.target),{spm:i={}}=o||{},r=We(Object.assign({},i,Be(window.location.href)),t);window.open(r,n)},tt=()=>{Me()?window.g_kio?De.userTrialFlag=window.g_kio.youke||"":te.warn("collectors.tuc","`window.g_kio` is not defined, trial user status won't be reported."):te.warn("collectors.tuc","TUC can only be initialized in a browser environment, ignored.")},nt=()=>{Me()&&window.document.cookie?De.qhdi=le("qhdi")||null:te.info("collectors.qhdi","No cookies found or unsupported enviroment, ignored.")},ot=()=>{if(Me())try{const e=function(e){const t=new URLSearchParams(e),n={utm_campaign:"",utm_content:"",utm_medium:"",utm_source:""};return Object.keys(n).forEach((e=>{n[e]=t.get(e)||""})),n}(window.location.search);De.utm=e}catch(e){te.error("collector.utm",["Error occured while parsing URL.",e])}else te.info("collectors.utm","Collector cannot be initialized on a non-browser environment.")};let it;const rt=Date.now();let st=Date.now();const at={_urlId:"",_href:"",_status:"",getUrl(){return this._urlId},getHref(){return this._href},setState(e){this._urlId=e.urlId||this._urlId,this._status=e.status||this._status,this._href=e.href||this._href},eqStatus(e){return this._status===e}};window.addEventListener("load",(()=>{it=Date.now()}));const lt=new Ge({name:"autotrack-and-ace",size:15,ttl:8e3,dispatcher:Re}),ct=new Ge({name:"default-next",size:10,ttl:3e3,dispatcher:(e,t)=>{var n,o;if(!e.length)return;const{g_kio:i,g_AppInfo:r}=window||{},{pubAppName:s,pubAppVersion:a,pubAppStage:l,userTrialFlag:c,qhdi:u,utm:d}=De||{},{utm_campaign:p,utm_content:g,utm_medium:h,utm_source:f}=d,{userId:v,rootAccountId:m,selfDomain:b}=i||{},{appId:w,name:k,vrc:y}=r||{},O=(T={$userId:v,$orgId:m,$userTrialFlag:c,$buDomain:b,$clientSendTime:Date.now(),$qhdi:u||void 0,$utmCampain:p,$utmContent:g,$utmMedium:h,$utmSource:f,$pubAppName:s||void 0,$pubAppVersion:a||void 0,$pubAppStage:l||void 0,$toolAppId:w,$toolName:k,$toolVrc:y,$toolVersion:null===window||void 0===window?void 0:window.app_version,$gaCookie:De.gaGaCookie||(null===(n=xe())||void 0===n?void 0:n.gaCookie),$gaSessionStates:De.gaCtnrCookie||(null===(o=xe())||void 0===o?void 0:o.ctnrCookie),$kioVersion:"3.8.1"},Object.keys(T).reduce(((e,t)=>(Boolean(T[t])&&(e[t]=T[t]),e)),{}));var T;const A=e.map((({queuedAt:e,job:t})=>{const{name:n,body:o,default:i={},shared:r={}}=t,s=[].concat(o||[]).filter((e=>!!e));if(!n||!s.length)return void te.warn("event-validator",`No properties found for event "${n}", ignored.`);const{properties:a,sharedProps:l}=new Ue(n,s,r,De.globalProps).dropIllegalKeyingProperties().dropEmptyPropertiesRecord().getProps();return a.length?(a.forEach((e=>{De.eventBus.emit("events.custom-events.pre-send",{eventName:n.toLowerCase(),rawEventName:n,defaultProps:Object.assign(Object.assign({},O),i),ownProps:Object.assign(Object.assign(Object.assign({},De.globalProps),l),e),$enqueueHandler:"uniq"})})),{eventName:n,sharedProps:Object.assign(Object.assign(Object.assign({},l),i),{$clientEnqueueTime:e}),properties:a}):void 0})).filter((e=>!!e));if(!A.length)return;((e,t,n)=>{const o=`https://actionstat.kujiale.com${e}`;n?re(e,t):se(o,t)})("/api/collect-events",Object.assign(Object.assign({$defaultProps:O},Object.keys(De.globalProps).length&&{globalProps:De.globalProps}),{events:A}))}});new Ge({name:"default",size:10,ttl:4e3,dispatcher:Re});const ut=function(){let e="hidden",t="visibilitychange";return void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),{hidden:e,visibilityChange:t}}();class dt{constructor(){this.getKpm=()=>(te.error("deprecation","Kio#getKpm 已在 3.5.0 移除, 请起初"),""),this.serializeSpm=Ye,this.spmOpen=et}open(e,t){window.open(t)}to(e,t){window.location.href=t}}class pt extends dt{constructor(e,t={},n={}){return super(),this.isKioInitialized=!1,this.isInAutoTrackSelectionMode=!1,this.onPageLoad=e=>{this.handleAutoTrack(this.mergeAutoTrackData({eventType:"loadEvent",triggerTimestamp:e}))},this.pl=this.onPageLoad,this.resetConfig=this.updateConfig,this.setManualCommon=this.setGlobalProps,this.setAutoCustomized=this.setAutoTrackExtraPayload,pt.instance?(te.warn("core","KIO is being re-initialized, configs and initial props will be shallow merged to the previous."),De.kioConfig=Object.assign(De.kioConfig,e||{}),De.globalProps=Object.assign(De.globalProps,t),De.autoTrackExtraPayload=Object.assign(De.autoTrackExtraPayload,n),pt.instance):(De.kioConfig=ue(e||{}),De.globalProps=ue(t),De.autoTrackExtraPayload=ue(n),this.pollQueues(),this.runCollectors(),this.attachPageUnloadListener(),this.connectWithTesseractAutoTrack(),window.setTimeout((()=>{this.isKioInitialized=!0,this.onPageViewEvent(rt),this.onPageLoad(it),document.addEventListener(ut.visibilityChange,this.onPageVisibilityChange.bind(this)),te.info("core","Initialized.")}),100),window.UI_AUTO_TEST&&(te.info("core","KIO is currently running on UI testing mode. You can safely access the KIO instance through `window.$kioUITestPortal`, as the actual instance may be referenced by a different variable."),window.$kioUITestPortal=this),pt.instance=this,window.__kioInternalInstancePortal=this,this)}attachPageUnloadListener(){window.addEventListener("pagehide",this.onPageDeactive.bind(this)),window.addEventListener("beforeunload",this.onPageDeactive.bind(this))}onPageVisibilityChange(){document[ut.hidden]?this.onPageDeactive():this.onPageActive()}connectWithTesseractAutoTrack(){const e=e=>{const t=function(e=window.location.hostname){const t=e.match(/(\w+\.\w+)$/);return t?t[1]:e}();e.origin.endsWith(t)&&"CIRCLE"===e.data&&(document.domain=t,this.isInAutoTrackSelectionMode=!0,this.onPageViewEvent())};window.addEventListener("message",e),setTimeout((()=>{window.removeEventListener("message",e)}),2e4),ae("KIO")}pollQueues(){ct.startPolling(),lt.startPolling()}handleAutoTrack(e,t){if(this.isInAutoTrackSelectionMode)ae(e);else{const n={key:"eventTrack",body:e};t?lt.flushQueue(n,"hard-flush"):lt.enqueue(n)}}collectorInitializer(e){e.forEach((e=>e&&e.call(this)))}initializeAutoTrack(){const e=e=>{const{element:t,autoTrackCustomized:n,manualTrackName:o,manualTrackData:i,conversionGoal:r}=Ie(e.target,{namespaceId:De.kioConfig.namespaceId,pageId:De.kioConfig.pageName||"",spaRouterMode:De.kioConfig.spaRouterMode,classIdMode:De.kioConfig.classIdMode,pageTimestamp:st});this.handleAutoTrack(this.mergeAutoTrackData({eventType:"clickEvent",element:t,customized:n})),o&&this.log(o,i),r&&this.logCG(r)},t=()=>{document.body.addEventListener("click",e,!0)};"loading"!==document.readyState?t():document.addEventListener("DOMContentLoaded",t),window.addEventListener("scroll",m((()=>{this.handleAutoTrack(this.mergeAutoTrackData({eventType:"scrollEvent",eventProps:{endPos:document.documentElement.scrollTop||document.body.scrollTop}}))}),300)),te.info("collectors.autotrack","Initialized.")}runCollectors(){var e;!0!==De.kioConfig.disableAutotrack?this.initializeAutoTrack():te.info("collectors.autotrack","Skipped as per config."),this.collectorInitializer([Ve,nt,tt,ot,xe]),(null===(e=De.kioConfig)||void 0===e?void 0:e.spm)&&Ze({pageEventTimestamp:rt,userId:De.kioConfig.userId||"",sendTrackEvent:this.sendTrackEvent.bind(this),mergeAutoTrackData:this.mergeAutoTrackData})}onPageViewEvent(e){if(!this.isKioInitialized)return;const t=ve(De.kioConfig.spaRouterMode),n=at.getUrl();n&&t!==n&&this.onPageDeactive(),this.onPageActive(e),this.handleAutoTrack(this.mergeAutoTrackData({eventType:"pageEvent",triggerTimestamp:e}))}onPageActive(e){const t=ve(De.kioConfig.spaRouterMode);t===at.getUrl()&&at.eqStatus("ACTIVE")||(at.setState({urlId:t,href:window.location.href,status:"ACTIVE"}),this.handleAutoTrack(this.mergeAutoTrackData({eventType:"activeEvent",triggerTimestamp:e})))}mergeAutoTrackData(e){return{behaviorDescription:"WebEventTrack",eventType:e.eventType,pageTimestamp:st,triggerTimestamp:e.triggerTimestamp||Date.now(),user:{userId:De.kioConfig.userId||"",qhdi:pe()},element:Object.assign({classIdMode:De.kioConfig.classIdMode,clientVersion:De.kioConfig.clientVersion||"",namespaceId:De.kioConfig.namespaceId,pageId:De.kioConfig.pageName||"",pageDescription:De.kioConfig.pageDescription||"",urlId:ve(De.kioConfig.spaRouterMode)},e.element),eventProps:Object.assign({url:window.location.href},e.eventProps),envProps:Object.assign({sdkVersion:"3.8.1",screenHeight:window.screen.height,screenWidth:window.screen.width,viewHeight:window.innerHeight,viewWidth:window.innerWidth},he(window.location.href)),customized:Object.assign({},De.autoTrackExtraPayload,e.customized)}}onPageDeactive(){ve(De.kioConfig.spaRouterMode)===at.getUrl()&&at.eqStatus("FREEZE")||(at.setState({status:"FREEZE"}),this.handleAutoTrack(this.mergeAutoTrackData({element:{urlId:at.getUrl()},eventProps:{url:at.getHref()},eventType:"freezeEvent"}),!0),ct.flushQueue())}log(e,t){ct.enqueue({key:"log",body:t,default:{$srcUrl:window.location.href,$pubCanaryApps:De.pubCanaryAppNamesCsv},name:e})}multiLog(e,t){var n;(null===(n=null==t?void 0:t.list)||void 0===n?void 0:n.length)?ct.enqueue({key:"multilog",body:t.list,default:{$srcUrl:window.location.href,$pubCanaryApps:De.pubCanaryAppNamesCsv},shared:t.common,name:e}):te.error("event-validator",`kio#multiLog is being called, but given a null or zero-length record list. This is a NO-OP, since KIO doesn't know how many events should be sent. (Related event name: "${e}")`)}pv(){st=Date.now(),this.onPageViewEvent()}sendTrackEvent(e,t,n){Array.isArray(e)?e.forEach((([e,n])=>{this.log(e,Object.assign({},(null==t?void 0:t.inlineCommon)||{},n))})):Array.isArray(t)?this.multiLog(e,{common:(null==n?void 0:n.sharedProps)||(null==n?void 0:n.common),list:t}):this.log(e,t),(null==n?void 0:n.sendImmediately)&&ct.flushQueue(null,"hard-flush")}addCustomEventPreSendOnceListener(e,t){const n=o=>{e.toLowerCase()===o.eventName&&(De.eventBus.off("events.custom-events.pre-send",n),t(o))};De.eventBus.on("events.custom-events.pre-send",n)}getConfig(e){return e?De.kioConfig[e]:De.kioConfig}updateConfig(e,t){De.kioConfig[e]=t}setGlobalProps(e,t){ct.flushQueue(null,"set-global-props"),"string"==typeof e?void 0!==t&&(De.globalProps[e]=ue(t)):De.globalProps=ue(e)}setAutoTrackExtraPayload(e,t){lt.flushQueue(null,"set-global-props"),"string"==typeof e?void 0!==t&&(De.autoTrackExtraPayload[e]=ue(t)):De.autoTrackExtraPayload=ue(e)}logCG(e){be.sendConversionGoal(Object.assign({userId:De.kioConfig.userId||"",triggertime:Date.now(),qhdi:pe(),url:window.location.href,conversionGoal:e,urlId:ve(De.kioConfig.spaRouterMode)},he(window.location.href)))}}return(...e)=>new pt(...e)}();
